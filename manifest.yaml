# =============================================================================
# Agent Development Rules - Manifest de Configuración v2.0
# =============================================================================
# Este archivo define la configuración central para sincronizar reglas
# a diferentes agentes de AI (Windsurf, GitHub Copilot, Cursor, Antigravity, etc.)
#
# Uso: ./scripts/sync.sh [--agent <nombre>] [--dry-run]
# =============================================================================

version: "2.0"

# =============================================================================
# Directorio de contenido (nueva estructura organizada)
# =============================================================================

content_dir: "content"

rules:
  source_dir: "rules"
  files:
    # Core - Reglas fundamentales
    - core/global.md
    - core/clean-code.md
    - core/solid.md
    # Languages - Por lenguaje
    - languages/go.md
    - languages/python.md
    - languages/nodejs.md
    - languages/bash.md
    # Infrastructure - IaC y DevOps
    - infrastructure/terraform.md
    - infrastructure/docker.md
    - infrastructure/kubernetes.md
    - infrastructure/aws.md
    # Quality - Calidad de código
    - quality/testing.md
    - quality/security.md
    - quality/performance.md
    - quality/scalability.md
    - quality/linting.md
    - quality/accessibility.md
    # Process - Procesos de desarrollo
    - process/git.md
    - process/documentation.md
    - process/operational-excellence.md
    # Agents - Específico por agente
    - agents/windsurf.md
    - agents/copilot.md

workflows:
  source_dir: "workflows"
  files:
    # Validation
    - validation/validate.md
    - validation/test.md
    - validation/lint.md
    # Git
    - git/pre-push.md
    - git/pr-review.md
    - git/fix-pr-comments.md
    # Infrastructure
    - infrastructure/terraform-module.md
    - infrastructure/docker-build.md
    - infrastructure/k8s-validate.md
    # Security
    - security/security-check.md

prompts:
  source_dir: "prompts"
  files:
    - review.prompt.md
    - security.prompt.md
    - test.prompt.md
    - refactor.prompt.md
    - document.prompt.md
    - validate.prompt.md
    - commit.prompt.md
    - explain.prompt.md
    - debug.prompt.md

# =============================================================================
# Configuración por Agente
# =============================================================================

agents:
  windsurf:
    enabled: true
    description: "Windsurf IDE / Codeium Cascade"
    detect:
      # Detectar si Windsurf está instalado
      paths:
        - "${HOME}/.codeium"
        - "/Applications/Windsurf.app"
      commands: []
    targets:
      rules:
        path: "${HOME}/.codeium/memories/global_rules.md"
        format: merged
        strip_frontmatter: true
        header: |
          ---
          trigger: always
          ---

          # Reglas de Desarrollo para Windsurf/Cascade

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

      workflows:
        path: "${HOME}/.codeium/global_workflows/default.md"
        format: merged
        strip_frontmatter: true
        header: |
          ---
          name: global-workflows
          description: Workflows globales para Windsurf
          ---

          # Workflows Globales

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  copilot-cli:
    enabled: true
    description: "GitHub Copilot CLI (gh copilot)"
    detect:
      paths: []
      commands:
        - "gh copilot --version"
    targets:
      instructions:
        path: "${HOME}/.config/gh-copilot/instructions.md"
        format: merged
        strip_frontmatter: true
        header: |
          # GitHub Copilot CLI - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  copilot-vscode:
    enabled: true
    description: "GitHub Copilot (VS Code)"
    detect:
      paths:
        - "${HOME}/.vscode/extensions"
      commands:
        - "code --list-extensions 2>/dev/null | grep -q github.copilot"
    targets:
      rules:
        path: "${HOME}/Library/Application Support/Code/User/prompts"
        glob_paths:
          - "${HOME}/.vscode/extensions/github.copilot-chat-*/assets/prompts"
        format: merged
        output_filename: "Default.instructions.md"
        strip_frontmatter: true
        header: |
          ---
          applyTo: "**"
          description: Instrucciones globales de desarrollo
          ---

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

      prompts:
        path: "${HOME}/Library/Application Support/Code/User/prompts"
        format: merged
        output_filename: "default.prompt.md"
        strip_frontmatter: true
        header: |
          ---
          description: Prompts reutilizables para tareas comunes
          ---

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  copilot-intellij:
    enabled: true
    description: "GitHub Copilot (IntelliJ/JetBrains)"
    detect:
      paths:
        - "${HOME}/Library/Application Support/JetBrains/*/plugins/github-copilot-intellij"
      commands: []
    targets:
      rules:
        path: "${HOME}/.config/github-copilot/intellij"
        format: merged
        output_filename: "Default.instructions.md"
        strip_frontmatter: true
        header: |
          ---
          applyTo: "**"
          description: Instrucciones globales de desarrollo
          ---

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

      prompts:
        path: "${HOME}/.config/github-copilot/intellij"
        format: merged
        output_filename: "default.prompt.md"
        strip_frontmatter: true
        header: |
          ---
          description: Prompts reutilizables para tareas comunes
          ---

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  cursor:
    enabled: true
    description: "Cursor IDE"
    detect:
      paths:
        - "/Applications/Cursor.app"
        - "${HOME}/.cursor"
      commands: []
    targets:
      rules:
        path: "${HOME}/.cursor/rules"
        format: individual
        output_extension: ".mdc"
        strip_frontmatter: false
        transform_frontmatter: true # paths -> globs, add description
        header: |
          ---
          description: "{{name}}"
          globs: []
          alwaysApply: true
          ---

  claude-code:
    enabled: true
    description: "Claude Code (Anthropic)"
    detect:
      paths:
        - "${HOME}/.claude"
      commands: []
    targets:
      rules:
        path: "${HOME}/.claude/rules"
        format: individual
        strip_frontmatter: false
      instructions:
        path: "${HOME}/.claude/CLAUDE.md"
        format: merged
        strip_frontmatter: true
        header: |
          # Claude Code - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  codex-cli:
    enabled: true
    description: "OpenAI Codex CLI"
    detect:
      paths: []
      commands:
        - "codex --version"
    targets:
      rules:
        path: "${HOME}/.codex/rules"
        format: individual
        strip_frontmatter: false
      instructions:
        path: "${HOME}/.codex/AGENTS.md"
        format: merged
        strip_frontmatter: true
        header: |
          # Codex CLI - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  gemini-cli:
    enabled: true
    description: "Google Gemini CLI"
    detect:
      paths: []
      commands:
        - "gemini --version"
    targets:
      rules:
        path: "${HOME}/.gemini/rules"
        format: individual
        strip_frontmatter: false
      instructions:
        path: "${HOME}/.gemini/GEMINI.md"
        format: merged
        strip_frontmatter: true
        header: |
          # Gemini CLI - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  antigravity:
    enabled: true
    description: "Google Antigravity IDE"
    detect:
      paths:
        - "/Applications/Antigravity.app"
        - "${HOME}/.gemini/antigravity"
      commands: []
    targets:
      rules:
        path: "${HOME}/.gemini/antigravity/rules"
        format: individual
        strip_frontmatter: false
      instructions:
        path: "${HOME}/.gemini/GEMINI.md"
        format: merged
        strip_frontmatter: true
        header: |
          # Google Antigravity - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

      workflows:
        path: "${HOME}/.gemini/antigravity/global_workflows"
        format: individual
        strip_frontmatter: false

  opencode:
    enabled: true
    description: "OpenCode"
    detect:
      paths: []
      commands:
        - "opencode --version"
    targets:
      rules:
        path: "${HOME}/.opencode/rules"
        format: individual
        strip_frontmatter: false
      instructions:
        path: "${HOME}/.opencode/AGENTS.md"
        format: merged
        strip_frontmatter: true
        header: |
          # OpenCode - Global Instructions

          <!-- Generado automáticamente por sync.sh -->
          <!-- Última actualización: {{timestamp}} -->

  local-project:
    enabled: false
    description: "Copiar reglas a proyecto local"
    targets:
      rules:
        path: ".windsurf/rules"
        format: individual
        strip_frontmatter: false
      workflows:
        path: ".windsurf/workflows"
        format: individual
        strip_frontmatter: false
